if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((s=>t.resolve(e()).then((()=>s))),(s=>t.resolve(e()).then((()=>{throw s}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";const t=(e,t)=>{const s=e.__vccOpts||e;for(const[o,i]of t)s[o]=i;return s};const s=t({data:()=>({wolUrl:"",macAddress:"",responseMessage:"",isErrorResponse:!1,showGuide:!0,historyList:[],historyListLabels:[],selectedHistoryIndex:-1,logList:[],isMenuVisible:!1,menuTop:0,menuRight:0,statusBarHeight:0}),computed:{selectedHistoryText(){var e;return this.selectedHistoryIndex>=0?null==(e=this.historyList[this.selectedHistoryIndex])?void 0:e.macAddress:""},responseLine1(){return this.responseMessage?this.isErrorResponse?"错误发生：\n":"✅ 操作成功：\n":""},responseLine2(){if(!this.responseMessage)return"";const e=this.responseMessage.split("：");return e[1]||e[0]}},onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight},mounted(){this.initDefaultValues(),this.loadHistory(),this.loadLogs(),this.showGuide=!uni.getStorageSync("hasViewedGuide")},methods:{hideGuide(){uni.setStorageSync("hasViewedGuide",!0),this.showGuide=!1},initDefaultValues(){this.wolUrl="http://nas.pwnhub.net:7690/wol",this.macAddress="6C-7F-12-18-15-1F"},onSelectHistory(e){const t=e.detail.value;this.selectedHistoryIndex=t,t>=0&&this.historyList[t]&&(this.wolUrl=this.historyList[t].wolUrl||"",this.macAddress=this.historyList[t].macAddress||"")},validateMac:e=>/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/.test(e),saveToHistory(){let e=uni.getStorageSync("wolHistory")||[];e.some((e=>e.macAddress===this.macAddress&&e.wolUrl===this.wolUrl))||(e.unshift({wolUrl:this.wolUrl,macAddress:this.macAddress}),uni.setStorageSync("wolHistory",e.slice(0,10)))},loadHistory(){this.historyList=uni.getStorageSync("wolHistory")||[],this.historyListLabels=this.historyList.map((e=>e.macAddress))},addLog(e,t){const s={time:(new Date).toLocaleString(),url:this.wolUrl,mac:this.macAddress,success:e,message:t};let o=uni.getStorageSync("wolLogs")||[];o.unshift(s),uni.setStorageSync("wolLogs",o.slice(0,30)),this.loadLogs()},loadLogs(){this.logList=uni.getStorageSync("wolLogs")||[]},fillFromLog(e){this.wolUrl=e.url,this.macAddress=e.mac},sendWolRequest(){this.wolUrl&&this.macAddress?this.validateMac(this.macAddress)?(this.saveToHistory(),uni.showLoading({title:"正在发送指令..."}),uni.request({url:`${this.wolUrl}?mac=${this.macAddress}`,method:"GET",success:e=>{var t,s;uni.hideLoading(),e.data&&0===e.data.error?(this.responseMessage=`操作成功：${e.data.message}`,this.isErrorResponse=!1,this.addLog(!0,e.data.message)):(this.responseMessage=`错误发生：${(null==(t=e.data)?void 0:t.message)||"未知错误"}`,this.isErrorResponse=!0,this.addLog(!1,(null==(s=e.data)?void 0:s.message)||"未知错误"))},fail:()=>{uni.hideLoading(),this.responseMessage="请求失败，请检查网络连接和地址是否正确",this.isErrorResponse=!0,this.addLog(!1,"请求失败，请检查网络连接和地址是否正确")}})):uni.showToast({title:"MAC 地址格式错误",icon:"none"}):uni.showToast({title:"请填写完整信息",icon:"none"})},toggleMenu(){uni.createSelectorQuery().select(".menu-trigger").boundingClientRect((e=>{e&&(this.menuTop=e.top+e.height,this.menuRight=uni.getSystemInfoSync().windowWidth-e.right,this.isMenuVisible=!this.isMenuVisible)})).exec()},goToHistoryManagement(){uni.navigateTo({url:"/pages/history-management/history-management"}),this.isMenuVisible=!1}}},[["render",function(t,s,o,i,a,n){const l=e.resolveComponent("statusBar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(l),e.createElementVNode("view",{style:e.normalizeStyle({height:a.statusBarHeight+"px"}),class:"status-bar-placeholder"},null,4),e.createElementVNode("scroll-view",{"scroll-y":"",class:"content-scroll"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"WOL 远程唤醒"),e.createElementVNode("text",{class:"subtitle"},"Wake-on-LAN 工具")]),e.createElementVNode("view",{class:"menu-trigger",onClick:s[0]||(s[0]=(...e)=>n.toggleMenu&&n.toggleMenu(...e))},[e.createElementVNode("image",{src:"/static/icons/more.png",mode:"aspectFit",class:"icon-more"})]),a.isMenuVisible?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-menu",style:e.normalizeStyle({top:a.menuTop+"px",right:a.menuRight+"px"})},[e.createElementVNode("view",{class:"menu-item",onClick:s[1]||(s[1]=(...e)=>n.goToHistoryManagement&&n.goToHistoryManagement(...e))},"历史记录管理")],4)):e.createCommentVNode("",!0),a.showGuide?(e.openBlock(),e.createElementBlock("view",{key:1,class:"guide-box"},[e.createElementVNode("text",{class:"guide-title"},"💡 使用提示"),e.createElementVNode("text",{class:"guide-text"},"接口地址格式：http://xxx.xxx.x.x:7690/wol"),e.createElementVNode("text",{class:"guide-text"},"MAC 地址格式：XX-XX-XX-XX-XX-XX"),e.createElementVNode("button",{class:"guide-btn",onClick:s[2]||(s[2]=(...e)=>n.hideGuide&&n.hideGuide(...e))},"我知道了")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"section-title",style:{"padding-bottom":"10px"}},"🔧 配置信息"),e.createElementVNode("picker",{mode:"selector","range-key":"macAddress",range:a.historyListLabels,onChange:s[3]||(s[3]=(...e)=>n.onSelectHistory&&n.onSelectHistory(...e)),class:"select-box",style:{"margin-top":"20rpx"}},[e.createElementVNode("view",{class:"select-content"},[a.selectedHistoryIndex>=0?(e.openBlock(),e.createElementBlock("text",{key:0},e.toDisplayString(n.selectedHistoryText),1)):(e.openBlock(),e.createElementBlock("text",{key:1,style:{color:"#999"}},"请选择历史记录")),e.createElementVNode("image",{src:"/static/icons/down-arrow.png",mode:"aspectFit",class:"arrow-icon"})])],40,["range"]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"WOL 接口地址"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=e=>a.wolUrl=e),placeholder:"请输入WOL接口地址",class:"input-field"},null,512),[[e.vModelText,a.wolUrl]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"目标设备 MAC "),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=e=>a.macAddress=e),placeholder:"例如：6C-7F-12-18-15-1F",class:"input-field"},null,512),[[e.vModelText,a.macAddress]])]),e.createElementVNode("button",{class:"submit-btn",onClick:s[6]||(s[6]=(...e)=>n.sendWolRequest&&n.sendWolRequest(...e))},"唤醒设备")]),a.responseMessage?(e.openBlock(),e.createElementBlock("view",{key:2,class:e.normalizeClass(["response-section",{success:!a.isErrorResponse,error:a.isErrorResponse}])},[e.createElementVNode("text",{class:"response-line"},e.toDisplayString(n.responseLine1),1),e.createElementVNode("text",{class:"response-line"},e.toDisplayString(n.responseLine2),1)],2)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"log-section"},[e.createElementVNode("text",{class:"section-title"},"📜 请求日志"),0===a.logList.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"log-empty"},[e.createElementVNode("text",null,"暂无操作记录")])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.logList.slice(0,10),((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:e.normalizeClass(["log-item",{success:t.success,error:!t.success}]),onClick:e=>n.fillFromLog(t)},[e.createElementVNode("text",{class:"log-time"},e.toDisplayString(t.time),1),e.createElementVNode("text",{class:"log-mac"},e.toDisplayString(t.mac),1),e.createElementVNode("text",{class:"log-status"},e.toDisplayString(t.success?"✅ 成功":"❌ 失败"),1)],10,["onClick"])))),128))])])])}]]);const o=t({data:()=>({statusBarHeight:0,devices:[],isEditModalVisible:!1,currentDevice:{},hasUnsavedChanges:!1}),onLoad(){const e=uni.getSystemInfoSync();this.statusBarHeight=e.statusBarHeight;const t=uni.getStorageSync("wolHistory")||[];this.devices=t.map((e=>({...e,remark:e.remark||""})))},methods:{openEditModal(e){this.currentDevice={...e},this.isEditModalVisible=!0},closeEditModal(){this.isEditModalVisible=!1,this.hasUnsavedChanges=!1},onRemarkInput(){this.hasUnsavedChanges=!0},saveRemark(e){const t=(uni.getStorageSync("wolHistory")||[]).map((t=>t.macAddress===e.macAddress?{...t,remark:e.remark}:t));uni.setStorageSync("wolHistory",t),this.closeEditModal(),this.devices=this.devices.map((t=>t.macAddress===e.macAddress?{...t,remark:e.remark}:t)),uni.showToast({title:"已保存备注"})},deleteDevice(e){uni.showModal({title:"确认删除",content:`是否删除该 MAC 地址：${this.devices[e].macAddress}？`,success:t=>{t.confirm&&(this.devices.splice(e,1),uni.setStorageSync("wolHistory",this.devices),uni.showToast({title:"删除成功"}))}})},clearAllHistory(){uni.showModal({title:"确认清空",content:"确定要清空所有历史记录吗？此操作不可恢复。",success:e=>{e.confirm&&(uni.setStorageSync("wolHistory",[]),this.devices=[],uni.showToast({title:"已清空"}))}})},goBack(){this.hasUnsavedChanges?uni.showModal({title:"注意",content:"您有未保存的修改，确定要离开吗？",success:e=>{e.confirm&&uni.navigateBack()}}):uni.navigateBack()}}},[["render",function(t,s,o,i,a,n){const l=e.resolveComponent("statusBar");return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createVNode(l),e.createElementVNode("view",{style:e.normalizeStyle({height:a.statusBarHeight+"px"}),class:"status-bar-placeholder"},null,4),e.createElementVNode("view",{class:"history-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("image",{src:"/static/icons/back.png",mode:"aspectFit",class:"back-icon",onClick:s[0]||(s[0]=(...e)=>n.goBack&&n.goBack(...e))}),e.createElementVNode("view",{class:"title-group"},[e.createElementVNode("text",{class:"title"},"历史记录管理"),e.createElementVNode("text",{class:"desc"},"可编辑设备备注或删除历史记录")]),e.createElementVNode("text",{class:"clear-btn",onClick:s[1]||(s[1]=(...e)=>n.clearAllHistory&&n.clearAllHistory(...e))},"清空全部")]),0===a.devices.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("image",{src:"/static/icons/empty-box.png",mode:"aspectFit",class:"empty-icon"}),e.createElementVNode("br"),e.createElementVNode("text",{class:"empty-text"},"暂无历史记录")])):e.createCommentVNode("",!0),e.createElementVNode("scroll-view",{"scroll-y":"",class:"device-list","scroll-with-animation":!0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.devices,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:"card"},[e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("text",{class:"mac-label"},"MAC地址："),e.createElementVNode("text",{class:"mac-address"},e.toDisplayString(t.macAddress),1)]),e.createElementVNode("view",{class:"card-footer"},[e.createElementVNode("text",{class:"remark-text"},e.toDisplayString(t.remark||"未填写备注"),1),e.createElementVNode("image",{src:"/static/icons/edit.png",mode:"aspectFit",class:"edit-icon",onClick:e=>n.openEditModal(t)},null,8,["onClick"]),e.createElementVNode("image",{src:"/static/icons/delete.png",mode:"aspectFit",class:"delete-icon",onClick:e=>n.deleteDevice(s)},null,8,["onClick"])])])))),128))]),a.isEditModalVisible?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-mask",onClick:s[6]||(s[6]=e.withModifiers(((...e)=>n.closeEditModal&&n.closeEditModal(...e)),["self"]))},[e.createElementVNode("view",{class:"modal-content"},[e.createElementVNode("text",{class:"modal-title"},"编辑备注"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=e=>a.currentDevice.remark=e),placeholder:"请输入备注（如：办公室主机）",class:"remark-input-modal",onInput:s[3]||(s[3]=(...e)=>n.onRemarkInput&&n.onRemarkInput(...e)),focus:""},null,544),[[e.vModelText,a.currentDevice.remark]]),e.createElementVNode("button",{class:"save-btn",onClick:s[4]||(s[4]=e=>n.saveRemark(a.currentDevice))},"保存"),e.createElementVNode("button",{class:"cancel-btn",onClick:s[5]||(s[5]=(...e)=>n.closeEditModal&&n.closeEditModal(...e))},"取消")])])):e.createCommentVNode("",!0)])])}]]);function i(e,t,...s){uni.__log__?uni.__log__(e,t,...s):console[e].apply(console,[...s,t])}__definePage("pages/index/index",s),__definePage("pages/history-management/history-management",o);const a={onLaunch(){i("log","at App.vue:4","App Launch")},onShow(){i("log","at App.vue:7","App Show")},onHide(){i("log","at App.vue:10","App Hide")}};const{app:n,Vuex:l,Pinia:r}={app:e.createVueApp(a)};uni.Vuex=l,uni.Pinia=r,n.provide("__globalStyles",__uniConfig.styles),n._component.mpType="app",n._component.render=()=>{},n.mount("#app")}(Vue);
